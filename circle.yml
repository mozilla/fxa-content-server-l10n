dependencies:
  pre:
    # update locally with:
    # openssl aes-256-cbc -e -in secret-env-plain -out secret-env-cipher -k $KEY
    - openssl aes-256-cbc -d -in secret-env-cipher -k $KEY >> ~/.circlerc
    - sudo apt-get update; sudo apt-get install gettext
    - npm install -g grunt-cli gh
    - GITHUB_TOKEN=$GITHUB_TOKEN GITHUB_USER=$GITHUB_USER node scripts/ci-creds.js
    - mkdir -p ~/.config/configstore/
    - echo optOut: true > ~/.config/configstore/insight-gh.yml


machine:
  node:
    version: 4

test:
  override:
    - >
      if [ -n "${RUN_NIGHTLY_BUILD}" ]; then
        ./scripts/extract-and-pull-request.sh; gh pr --submit mozilla --branch master;
      fi
